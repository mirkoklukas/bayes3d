<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.433">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="McCoy Reynolds Becker">
<meta name="dcterms.date" content="2022-01-14">

<title>Gen ⊗ JAX - Demo 0: GenJAX performance characteristics</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


<meta property="og:title" content="Gen ⊗ JAX - Demo 0: GenJAX performance characteristics">
<meta property="og:description" content="A first look at GenJAX. The focus is on showcasing performance characteristics when using the JAX platform to implement Gen’s interfaces. We focus on a curve-fitting task which includes a prior over polynomials and outlier indication, and showcase performance comparisons between CPU and GPU for several variants of inference.">
<meta property="og:image" content="genjax_expo_0_files/figure-html/cell-6-output-1.png">
<meta property="og:site-name" content="Gen ⊗ JAX">
</head>

<body class="nav-sidebar floating slimcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item">Demo 0: GenJAX performance characteristics</li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-center sidebar-header">
      <a href="../index.html" class="sidebar-logo-link">
      <img src="../logo.png" alt="" class="sidebar-logo py-0 d-lg-inline d-none">
      </a>
      <div class="sidebar-tools-main tools-wide">
    <a href="../" rel="" title="Home" class="quarto-navigation-tool px-1" aria-label="Home"><i class="bi bi-house-heart"></i></a>
    <a href="http://probcomp.csail.mit.edu/" rel="" title="MIT Probabilistic Computing Project" class="quarto-navigation-tool px-1" aria-label="MIT Probabilistic Computing Project"><i class="bi bi-building"></i></a>
    <a href="https://github.com/probcomp/genjax" rel="" title="GitHub repository" class="quarto-navigation-tool px-1" aria-label="GitHub repository"><i class="bi bi-github"></i></a>
</div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="false">
 <span class="menu-text">Getting started</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../concepts/introduction/intro_to_genjax.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../concepts/combinators/intro_to_combinators.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">(WIP) Generative function combinators</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../concepts/incremental_computation/incremental.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">(WIP) Incremental computing</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="px-0"><hr class="sidebar-divider hi "></li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="false">
 <span class="menu-text">Inference programming</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../intermediate/gaussian_processes/gaussian_processes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">(WIP) Gaussian processes</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../advanced/gen_sp/gen_sp.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><code>GenSP</code> (density estimates)</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#current-modeling-languages-static-combinators" id="toc-current-modeling-languages-static-combinators" class="nav-link active" data-scroll-target="#current-modeling-languages-static-combinators">Current modeling languages ~ static + combinators</a></li>
  <li><a href="#inference-v0-importance-sampling" id="toc-inference-v0-importance-sampling" class="nav-link" data-scroll-target="#inference-v0-importance-sampling">Inference v0: Importance sampling</a>
  <ul class="collapse">
  <li><a href="#benchmarking-importance-sampling" id="toc-benchmarking-importance-sampling" class="nav-link" data-scroll-target="#benchmarking-importance-sampling">Benchmarking importance sampling</a></li>
  </ul></li>
  <li><a href="#interim-ad-interfaces-in-genjax" id="toc-interim-ad-interfaces-in-genjax" class="nav-link" data-scroll-target="#interim-ad-interfaces-in-genjax">Interim: AD interfaces in GenJAX</a>
  <ul class="collapse">
  <li><a href="#implementing-map" id="toc-implementing-map" class="nav-link" data-scroll-target="#implementing-map">Implementing MAP</a></li>
  </ul></li>
  <li><a href="#inference-v1-map-initialization-mhmala-chain" id="toc-inference-v1-map-initialization-mhmala-chain" class="nav-link" data-scroll-target="#inference-v1-map-initialization-mhmala-chain">Inference v1: MAP initialization + MH/MALA chain</a>
  <ul class="collapse">
  <li><a href="#chain-idioms-in-jax" id="toc-chain-idioms-in-jax" class="nav-link" data-scroll-target="#chain-idioms-in-jax">Chain idioms in JAX</a></li>
  <li><a href="#benchmarking-map-malamh" id="toc-benchmarking-map-malamh" class="nav-link" data-scroll-target="#benchmarking-map-malamh">Benchmarking MAP + MALA/MH</a></li>
  </ul></li>
  <li><a href="#inference-v2-importance-sampling-with-mhmala-rejuvenation" id="toc-inference-v2-importance-sampling-with-mhmala-rejuvenation" class="nav-link" data-scroll-target="#inference-v2-importance-sampling-with-mhmala-rejuvenation">Inference v2: Importance sampling with MH/MALA rejuvenation</a>
  <ul class="collapse">
  <li><a href="#benchmarking-is-malamh-rejuvenation" id="toc-benchmarking-is-malamh-rejuvenation" class="nav-link" data-scroll-target="#benchmarking-is-malamh-rejuvenation">Benchmarking IS + MALA/MH rejuvenation</a></li>
  </ul></li>
  </ul>
<div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.dev/probcomp/genjax/blob/main/hidden/genjax_expo_0.ipynb" class="toc-action">Edit this page</a></p><p><a href="https://github.com/probcomp/genjax/issues/new" class="toc-action">Report an issue</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content page-columns page-full" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Demo 0: GenJAX performance characteristics</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>McCoy Reynolds Becker </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">January 14, 2022</p>
    </div>
  </div>
  
    
  </div>
  
<div>
  <div class="abstract">
    <div class="abstract-title">Abstract</div>
    A first look at GenJAX. The focus is on showcasing performance characteristics when using the JAX platform to implement Gen’s interfaces. We focus on a curve-fitting task which includes a prior over polynomials and outlier indication, and showcase performance comparisons between CPU and GPU for several variants of inference.
  </div>
</div>

</header>

<div class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> time</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> jax</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> jax.numpy <span class="im">as</span> jnp</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> jax.tree_util <span class="im">as</span> jtu</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> dataclasses</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> matplotlib.animation <span class="im">import</span> FuncAnimation</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> genjax</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> genjax.typing <span class="im">import</span> FloatArray, IntArray, Union, PRNGKey, Tuple</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> genjax <span class="im">import</span> GenerativeFunction, ChoiceMap, Selection, trace</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>sns.set_theme(style<span class="op">=</span><span class="st">"white"</span>)</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>plt.rcParams[<span class="st">"figure.figsize"</span>] <span class="op">=</span> [<span class="dv">8</span>, <span class="dv">8</span>]</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Pretty printing.</span></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>console <span class="op">=</span> genjax.pretty(width<span class="op">=</span><span class="dv">80</span>)</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Reproducibility.</span></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>key <span class="op">=</span> jax.random.PRNGKey(<span class="dv">314159</span>)</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Device management.</span></span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>cpu_device <span class="op">=</span> jax.devices(<span class="st">"cpu"</span>)[<span class="dv">0</span>]</span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a><span class="cf">try</span>:</span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>    gpu_device <span class="op">=</span> jax.devices(<span class="st">"gpu"</span>)[<span class="dv">0</span>]</span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a><span class="cf">except</span>:</span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a>    gpu_device <span class="op">=</span> jax.devices(<span class="st">"cpu"</span>)[<span class="dv">0</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>This notebook showcases key performance attributes of GenJAX.</p>
<p>It highlights performance improvements due to parallelism, as well as the efficacy of using JAX AD to support gradient moves - however, it does not contain comparisons with other language implementations of Gen.</p>
<p>The hardware characteristics of my experiment device is shown below.</p>
<div class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="op">!</span> neofetch <span class="op">--</span>stdout</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>mccoy@pop-os 
------------ 
OS: Pop!_OS 22.04 LTS x86_64 
Kernel: 6.0.12-76060006-generic 
Uptime: 13 hours, 8 mins 
Packages: 2348 (dpkg) 
Shell: zsh 5.8.1 
Resolution: 1920x1080 
DE: GNOME 42.3.1 
WM: Mutter 
WM Theme: Pop 
Theme: Pop-dark [GTK2/3] 
Icons: Pop [GTK2/3] 
Terminal: jupyter-lab 
CPU: AMD Ryzen 9 3900XT (24) @ 4.100GHz 
GPU: NVIDIA GeForce RTX 2080 
Memory: 3401MiB / 32008MiB 
</code></pre>
</div>
</div>
<section id="current-modeling-languages-static-combinators" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="current-modeling-languages-static-combinators">Current modeling languages ~ static + combinators</h2>
<div class="page-columns page-full"><p>The current set of modeling languages plus combinators is roughly equivalent to the (static modeling language plus combinators) subset of <code>Gen.jl</code><a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a>.</p><div class="no-row-height column-margin column-container"><li id="fn1"><p><sup>1</sup>&nbsp;There are a few things that you can do beyond what is possible in the static modeling language (like use Python control flow evaluated at tracing time to perform codegen into the model) - but in general, these capabilities are syntactical sugar in nature.</p></li></div></div>
<p>Let’s create a polynomial regression model with degree selection and outlier detection.</p>
<div class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Branching model with two submodels.</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>switch <span class="op">=</span> genjax.Switch(</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>    <span class="bu">list</span>(</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>        <span class="bu">map</span>(</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>            genjax.gen,</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>            [</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>                <span class="kw">lambda</span> pv: trace(<span class="st">"value"</span>, genjax.Normal)(pv, <span class="fl">1.0</span>),</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>                <span class="kw">lambda</span> pv: trace(<span class="st">"value"</span>, genjax.Normal)(pv, <span class="fl">20.0</span>),</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>            ],</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a><span class="co"># A model vectorized over `x` which calls the branching model.</span></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a><span class="at">@genjax.gen</span>(genjax.Map, in_axes<span class="op">=</span>(<span class="dv">0</span>, <span class="va">None</span>, <span class="va">None</span>))</span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> kernel(x, coefficients, basis_degrees):</span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>    is_outlier <span class="op">=</span> trace(<span class="st">"outlier"</span>, genjax.Bernoulli)(<span class="fl">0.05</span>)</span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>    is_outlier <span class="op">=</span> jnp.asarray(is_outlier, dtype<span class="op">=</span><span class="bu">int</span>)</span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>    polynomial_value <span class="op">=</span> jnp.<span class="bu">sum</span>((x<span class="op">**</span>basis_degrees) <span class="op">*</span> coefficients)</span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a>    y <span class="op">=</span> trace(<span class="st">"y"</span>, switch)(is_outlier, polynomial_value)</span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> y</span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Here, `max_length` must be static at tracing time - it affects the shape</span></span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a><span class="co"># of arrays in certain parts of the computation.</span></span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true" tabindex="-1"></a><span class="at">@genjax.gen</span></span>
<span id="cb4-27"><a href="#cb4-27" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> model(xs):</span>
<span id="cb4-28"><a href="#cb4-28" aria-hidden="true" tabindex="-1"></a>    max_degree <span class="op">=</span> <span class="dv">5</span></span>
<span id="cb4-29"><a href="#cb4-29" aria-hidden="true" tabindex="-1"></a>    coefficients <span class="op">=</span> trace(<span class="st">"alpha"</span>, genjax.Map(genjax.TFPUniform, repeats<span class="op">=</span>max_degree))(</span>
<span id="cb4-30"><a href="#cb4-30" aria-hidden="true" tabindex="-1"></a>        <span class="op">-</span><span class="fl">3.0</span>, <span class="fl">3.0</span></span>
<span id="cb4-31"><a href="#cb4-31" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb4-32"><a href="#cb4-32" aria-hidden="true" tabindex="-1"></a>    basis_degrees <span class="op">=</span> jnp.arange(max_degree)</span>
<span id="cb4-33"><a href="#cb4-33" aria-hidden="true" tabindex="-1"></a>    ys <span class="op">=</span> trace(<span class="st">"ys"</span>, kernel)(xs, coefficients, basis_degrees)</span>
<span id="cb4-34"><a href="#cb4-34" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> ys</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Let’s sample a trace and examine it. Notice how the representation is a struct-of-array representation - even for submaps below <code>MapTrace</code>.</p>
<p>In GenJAX currently, combinators like <code>Map</code> don’t split the tree into separate instances - they provide indicators of broadcast semantics and raise the rank of the arrays from computations which they shadow. Something similar is true for <code>Unfold</code>.</p>
<div class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> jnp.arange(<span class="op">-</span><span class="fl">2.0</span>, <span class="fl">2.0</span>, <span class="fl">0.05</span>)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>key, tr <span class="op">=</span> jax.jit(model.simulate)(key, (data,))</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>tr</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"></pre>
</div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="font-weight: bold">BuiltinTrace</span>
├── gen_fn
│   └── <span style="font-weight: bold">BuiltinGenerativeFunction</span>
│       └── source
│           └── &lt;function model&gt;
├── args
│   └── <span style="font-weight: bold">tuple</span>
│       └──  f32[80]
├── retval
│   └──  f32[80]
├── choices
│   └── <span style="font-weight: bold">Trie</span>
│       ├── <span style="font-weight: bold">:alpha</span>
│       │   └── <span style="font-weight: bold">MapTrace</span>
│       │       ├── gen_fn
│       │       │   └── <span style="font-weight: bold">MapCombinator</span>
│       │       │       ├── in_axes
│       │       │       │   └── (const) None
│       │       │       ├── repeats
│       │       │       │   └── (const) 5
│       │       │       └── kernel
│       │       │           └── <span style="font-weight: bold">TFPDistribution</span>
│       │       │               └── distribution
│       │       │                   └── (const) &lt;class 
│       │       │                       'tensorflow_probability.substrates.jax.distributions.uniform.Uniform'&gt;
│       │       ├── indices
│       │       │   └──  i32[5]
│       │       ├── inner
│       │       │   └── <span style="font-weight: bold">DistributionTrace</span>
│       │       │       ├── gen_fn
│       │       │       │   └── <span style="font-weight: bold">TFPDistribution</span>
│       │       │       │       └── distribution
│       │       │       │           └── (const) &lt;class 
│       │       │       │               'tensorflow_probability.substrates.jax.distributions.uniform.Uniform'&gt;
│       │       │       ├── args
│       │       │       │   └── <span style="font-weight: bold">tuple</span>
│       │       │       │       ├──  f32[5]
│       │       │       │       └──  f32[5]
│       │       │       ├── value
│       │       │       │   └──  f32[5]
│       │       │       └── score
│       │       │           └──  f32[5]
│       │       └── score
│       │           └──  f32[]
│       └── <span style="font-weight: bold">:ys</span>
│           └── <span style="font-weight: bold">MapTrace</span>
│               ├── gen_fn
│               │   └── <span style="font-weight: bold">MapCombinator</span>
│               │       ├── in_axes
│               │       │   └── <span style="font-weight: bold">tuple</span>
│               │       │       ├── (const) 0
│               │       │       ├── (const) None
│               │       │       └── (const) None
│               │       ├── repeats
│               │       │   └── (const) None
│               │       └── kernel
│               │           └── <span style="font-weight: bold">BuiltinGenerativeFunction</span>
│               │               └── source
│               │                   └── &lt;function kernel&gt;
│               ├── indices
│               │   └──  i32[80]
│               ├── inner
│               │   └── <span style="font-weight: bold">BuiltinTrace</span>
│               │       ├── gen_fn
│               │       │   └── <span style="font-weight: bold">BuiltinGenerativeFunction</span>
│               │       │       └── source
│               │       │           └── &lt;function kernel&gt;
│               │       ├── args
│               │       │   └── <span style="font-weight: bold">tuple</span>
│               │       │       ├──  f32[80]
│               │       │       ├──  f32[80,5]
│               │       │       └──  i32[80,5]
│               │       ├── retval
│               │       │   └──  f32[80]
│               │       ├── choices
│               │       │   └── <span style="font-weight: bold">Trie</span>
│               │       │       ├── <span style="font-weight: bold">:outlier</span>
│               │       │       │   └── <span style="font-weight: bold">DistributionTrace</span>
│               │       │       │       ├── gen_fn
│               │       │       │       │   └── <span style="font-weight: bold">_Bernoulli</span>
│               │       │       │       ├── args
│               │       │       │       │   └── <span style="font-weight: bold">tuple</span>
│               │       │       │       │       └──  f32[80]
│               │       │       │       ├── value
│               │       │       │       │   └──  bool[80]
│               │       │       │       └── score
│               │       │       │           └──  f32[80]
│               │       │       └── <span style="font-weight: bold">:y</span>
│               │       │           └── <span style="font-weight: bold">SwitchTrace</span>
│               │       │               ├── gen_fn
│               │       │               │   └── <span style="font-weight: bold">SwitchCombinator</span>
│               │       │               │       └── branches
│               │       │               │           └── <span style="font-weight: bold">list</span>
│               │       │               │               ├── <span style="font-weight: bold">BuiltinGenerativeFunction</span>
│               │       │               │               │   └── source
│               │       │               │               │       └── &lt;function &lt;lambda&gt;&gt;
│               │       │               │               └── <span style="font-weight: bold">BuiltinGenerativeFunction</span>
│               │       │               │                   └── source
│               │       │               │                       └── &lt;function &lt;lambda&gt;&gt;
│               │       │               ├── chm
│               │       │               │   └── <span style="font-weight: bold">IndexedChoiceMap</span>
│               │       │               │       ├── index
│               │       │               │       │   └──  i32[80]
│               │       │               │       └── submaps
│               │       │               │           └── <span style="font-weight: bold">list</span>
│               │       │               │               ├── <span style="font-weight: bold">BuiltinTrace</span>
│               │       │               │               │   ├── gen_fn
│               │       │               │               │   │   └── <span style="font-weight: bold">BuiltinGenerativeFunction</span>
│               │       │               │               │   │       └── source
│               │       │               │               │   │           └── &lt;function &lt;lambda&gt;&gt;
│               │       │               │               │   ├── args
│               │       │               │               │   │   └── <span style="font-weight: bold">tuple</span>
│               │       │               │               │   │       └──  f32[80]
│               │       │               │               │   ├── retval
│               │       │               │               │   │   └──  f32[80]
│               │       │               │               │   ├── choices
│               │       │               │               │   │   └── <span style="font-weight: bold">Trie</span>
│               │       │               │               │   │       └── <span style="font-weight: bold">:value</span>
│               │       │               │               │   │           └── <span style="font-weight: bold">DistributionTrace</span>
│               │       │               │               │   │               ├── gen_fn
│               │       │               │               │   │               │   └── <span style="font-weight: bold">_Normal</span>
│               │       │               │               │   │               ├── args
│               │       │               │               │   │               │   └── <span style="font-weight: bold">tuple</span>
│               │       │               │               │   │               │       ├──  f32[80]
│               │       │               │               │   │               │       └──  f32[80]
│               │       │               │               │   │               ├── value
│               │       │               │               │   │               │   └──  f32[80]
│               │       │               │               │   │               └── score
│               │       │               │               │   │                   └──  f32[80]
│               │       │               │               │   ├── cache
│               │       │               │               │   │   └── <span style="font-weight: bold">Trie</span>
│               │       │               │               │   └── score
│               │       │               │               │       └──  f32[80]
│               │       │               │               └── <span style="font-weight: bold">BuiltinTrace</span>
│               │       │               │                   ├── gen_fn
│               │       │               │                   │   └── <span style="font-weight: bold">BuiltinGenerativeFunction</span>
│               │       │               │                   │       └── source
│               │       │               │                   │           └── &lt;function &lt;lambda&gt;&gt;
│               │       │               │                   ├── args
│               │       │               │                   │   └── <span style="font-weight: bold">tuple</span>
│               │       │               │                   │       └──  f32[80]
│               │       │               │                   ├── retval
│               │       │               │                   │   └──  f32[80]
│               │       │               │                   ├── choices
│               │       │               │                   │   └── <span style="font-weight: bold">Trie</span>
│               │       │               │                   │       └── <span style="font-weight: bold">:value</span>
│               │       │               │                   │           └── <span style="font-weight: bold">DistributionTrace</span>
│               │       │               │                   │               ├── gen_fn
│               │       │               │                   │               │   └── <span style="font-weight: bold">_Normal</span>
│               │       │               │                   │               ├── args
│               │       │               │                   │               │   └── <span style="font-weight: bold">tuple</span>
│               │       │               │                   │               │       ├──  f32[80]
│               │       │               │                   │               │       └──  f32[80]
│               │       │               │                   │               ├── value
│               │       │               │                   │               │   └──  f32[80]
│               │       │               │                   │               └── score
│               │       │               │                   │                   └──  f32[80]
│               │       │               │                   ├── cache
│               │       │               │                   │   └── <span style="font-weight: bold">Trie</span>
│               │       │               │                   └── score
│               │       │               │                       └──  f32[80]
│               │       │               ├── args
│               │       │               │   └── <span style="font-weight: bold">tuple</span>
│               │       │               │       └──  f32[80]
│               │       │               ├── retval
│               │       │               │   └──  f32[80]
│               │       │               └── score
│               │       │                   └──  f32[80]
│               │       ├── cache
│               │       │   └── <span style="font-weight: bold">Trie</span>
│               │       └── score
│               │           └──  f32[80]
│               └── score
│                   └──  f32[]
├── cache
│   └── <span style="font-weight: bold">Trie</span>
└── score
    └──  f32[]
</pre>
</div>
</div>
<p>Let’s visualize some samples from our model.</p>
<div class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> viz(ax, x, y, <span class="op">**</span>kwargs):</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>    sns.scatterplot(x<span class="op">=</span>x, y<span class="op">=</span>y, ax<span class="op">=</span>ax, <span class="op">**</span>kwargs)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>f, axes <span class="op">=</span> plt.subplots(<span class="dv">4</span>, <span class="dv">4</span>, sharex<span class="op">=</span><span class="va">True</span>, sharey<span class="op">=</span><span class="va">True</span>, dpi<span class="op">=</span><span class="dv">280</span>)</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>jitted <span class="op">=</span> jax.jit(model.simulate)</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> ax <span class="kw">in</span> axes.flatten():</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>    key, tr <span class="op">=</span> jitted(key, (data,))</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>    x <span class="op">=</span> data</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>    y <span class="op">=</span> tr.get_retval()</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>    viz(ax, x, y, marker<span class="op">=</span><span class="st">"."</span>)</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="genjax_expo_0_files/figure-html/cell-6-output-1.png" class="img-fluid"></p>
</div>
</div>
</section>
<section id="inference-v0-importance-sampling" class="level2">
<h2 class="anchored" data-anchor-id="inference-v0-importance-sampling">Inference v0: Importance sampling</h2>
<p>Importance sampling (and SIR) are embarrassingly parallel. We can run an importance sampling routine and compare the performance characteristics on different devices.</p>
<div class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>(genjax.ImportanceSampling, genjax.SamplingImportanceResampling)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="font-weight: bold">(</span>
    <span style="font-weight: bold">&lt;</span><span style="color: #ff00ff; text-decoration-color: #ff00ff; font-weight: bold">class</span><span style="color: #000000; text-decoration-color: #000000"> </span><span style="color: #008000; text-decoration-color: #008000">'genjax._src.inference.importance_sampling.ImportanceSampling'</span><span style="font-weight: bold">&gt;</span>,
    <span style="font-weight: bold">&lt;</span><span style="color: #ff00ff; text-decoration-color: #ff00ff; font-weight: bold">class</span><span style="color: #000000; text-decoration-color: #000000"> </span><span style="color: #008000; text-decoration-color: #008000">'genjax._src.inference.importance_sampling.SamplingImportanceResampling'</span><span style="font-weight: bold">&gt;</span>
<span style="font-weight: bold">)</span>
</pre>
</div>
</div>
<p>Just for enlightenment - let’s briefly look at the code for <code>ImportanceSampling</code>.</p>
<div class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="at">@dataclasses.dataclass</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> ImportanceSampling(genjax.Pytree):</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>    num_particles: IntArray</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>    model: GenerativeFunction</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>    proposal: Union[<span class="va">None</span>, GenerativeFunction] <span class="op">=</span> <span class="va">None</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> flatten(<span class="va">self</span>):</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> (), (<span class="va">self</span>.num_particles, <span class="va">self</span>.model, <span class="va">self</span>.proposal)</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">@classmethod</span></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> new(</span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>        cls,</span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>        num_particles: IntArray,</span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>        model: GenerativeFunction,</span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>        proposal: Union[<span class="va">None</span>, GenerativeFunction] <span class="op">=</span> <span class="va">None</span>,</span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>    ):</span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> ImportanceSampling(</span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>            num_particles,</span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a>            model,</span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a>            proposal<span class="op">=</span>proposal,</span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> _bootstrap_importance_sampling(</span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>,</span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a>        key: PRNGKey,</span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true" tabindex="-1"></a>        observations: ChoiceMap,</span>
<span id="cb8-27"><a href="#cb8-27" aria-hidden="true" tabindex="-1"></a>        model_args: Tuple,</span>
<span id="cb8-28"><a href="#cb8-28" aria-hidden="true" tabindex="-1"></a>    ):</span>
<span id="cb8-29"><a href="#cb8-29" aria-hidden="true" tabindex="-1"></a>        key, <span class="op">*</span>sub_keys <span class="op">=</span> jax.random.split(key, <span class="va">self</span>.num_particles <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb8-30"><a href="#cb8-30" aria-hidden="true" tabindex="-1"></a>        sub_keys <span class="op">=</span> jnp.array(sub_keys)</span>
<span id="cb8-31"><a href="#cb8-31" aria-hidden="true" tabindex="-1"></a>        _, (lws, trs) <span class="op">=</span> jax.vmap(<span class="va">self</span>.model.importance, in_axes<span class="op">=</span>(<span class="dv">0</span>, <span class="va">None</span>, <span class="va">None</span>))(</span>
<span id="cb8-32"><a href="#cb8-32" aria-hidden="true" tabindex="-1"></a>            sub_keys,</span>
<span id="cb8-33"><a href="#cb8-33" aria-hidden="true" tabindex="-1"></a>            observations,</span>
<span id="cb8-34"><a href="#cb8-34" aria-hidden="true" tabindex="-1"></a>            model_args,</span>
<span id="cb8-35"><a href="#cb8-35" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb8-36"><a href="#cb8-36" aria-hidden="true" tabindex="-1"></a>        log_total_weight <span class="op">=</span> jax.scipy.special.logsumexp(lws)</span>
<span id="cb8-37"><a href="#cb8-37" aria-hidden="true" tabindex="-1"></a>        log_normalized_weights <span class="op">=</span> lws <span class="op">-</span> log_total_weight</span>
<span id="cb8-38"><a href="#cb8-38" aria-hidden="true" tabindex="-1"></a>        log_ml_estimate <span class="op">=</span> log_total_weight <span class="op">-</span> jnp.log(<span class="va">self</span>.num_particles)</span>
<span id="cb8-39"><a href="#cb8-39" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> key, (trs, log_normalized_weights, log_ml_estimate)</span>
<span id="cb8-40"><a href="#cb8-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-41"><a href="#cb8-41" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> _proposal_importance_sampling(</span>
<span id="cb8-42"><a href="#cb8-42" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>,</span>
<span id="cb8-43"><a href="#cb8-43" aria-hidden="true" tabindex="-1"></a>        key: PRNGKey,</span>
<span id="cb8-44"><a href="#cb8-44" aria-hidden="true" tabindex="-1"></a>        observations: ChoiceMap,</span>
<span id="cb8-45"><a href="#cb8-45" aria-hidden="true" tabindex="-1"></a>        model_args: Tuple,</span>
<span id="cb8-46"><a href="#cb8-46" aria-hidden="true" tabindex="-1"></a>        proposal_args: Tuple,</span>
<span id="cb8-47"><a href="#cb8-47" aria-hidden="true" tabindex="-1"></a>    ):</span>
<span id="cb8-48"><a href="#cb8-48" aria-hidden="true" tabindex="-1"></a>        key, <span class="op">*</span>sub_keys <span class="op">=</span> jax.random.split(key, <span class="va">self</span>.num_particles <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb8-49"><a href="#cb8-49" aria-hidden="true" tabindex="-1"></a>        sub_keys <span class="op">=</span> jnp.array(sub_keys)</span>
<span id="cb8-50"><a href="#cb8-50" aria-hidden="true" tabindex="-1"></a>        _, p_trs <span class="op">=</span> jax.vmap(<span class="va">self</span>.proposal.simulate, in_axes<span class="op">=</span>(<span class="dv">0</span>, <span class="va">None</span>, <span class="va">None</span>))(</span>
<span id="cb8-51"><a href="#cb8-51" aria-hidden="true" tabindex="-1"></a>            sub_keys,</span>
<span id="cb8-52"><a href="#cb8-52" aria-hidden="true" tabindex="-1"></a>            observations,</span>
<span id="cb8-53"><a href="#cb8-53" aria-hidden="true" tabindex="-1"></a>            proposal_args,</span>
<span id="cb8-54"><a href="#cb8-54" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb8-55"><a href="#cb8-55" aria-hidden="true" tabindex="-1"></a>        observations <span class="op">=</span> jax.tree_util.<span class="bu">map</span>(</span>
<span id="cb8-56"><a href="#cb8-56" aria-hidden="true" tabindex="-1"></a>            <span class="kw">lambda</span> v: jnp.repeats(v, <span class="va">self</span>.num_particles), observations</span>
<span id="cb8-57"><a href="#cb8-57" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb8-58"><a href="#cb8-58" aria-hidden="true" tabindex="-1"></a>        chm <span class="op">=</span> p_trs.get_choices().merge(observations)</span>
<span id="cb8-59"><a href="#cb8-59" aria-hidden="true" tabindex="-1"></a>        key, <span class="op">*</span>sub_keys <span class="op">=</span> jax.random.split(key, <span class="va">self</span>.num_particles <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb8-60"><a href="#cb8-60" aria-hidden="true" tabindex="-1"></a>        sub_keys <span class="op">=</span> jnp.array(sub_keys)</span>
<span id="cb8-61"><a href="#cb8-61" aria-hidden="true" tabindex="-1"></a>        _, (lws, m_trs) <span class="op">=</span> jax.vmap(<span class="va">self</span>.model.importance, in_axes<span class="op">=</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="va">None</span>))(</span>
<span id="cb8-62"><a href="#cb8-62" aria-hidden="true" tabindex="-1"></a>            sub_keys,</span>
<span id="cb8-63"><a href="#cb8-63" aria-hidden="true" tabindex="-1"></a>            chm,</span>
<span id="cb8-64"><a href="#cb8-64" aria-hidden="true" tabindex="-1"></a>            model_args,</span>
<span id="cb8-65"><a href="#cb8-65" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb8-66"><a href="#cb8-66" aria-hidden="true" tabindex="-1"></a>        lws <span class="op">=</span> lws <span class="op">-</span> p_trs.get_score()</span>
<span id="cb8-67"><a href="#cb8-67" aria-hidden="true" tabindex="-1"></a>        log_total_weight <span class="op">=</span> jax.scipy.special.logsumexp(lws)</span>
<span id="cb8-68"><a href="#cb8-68" aria-hidden="true" tabindex="-1"></a>        log_normalized_weights <span class="op">=</span> lws <span class="op">-</span> log_total_weight</span>
<span id="cb8-69"><a href="#cb8-69" aria-hidden="true" tabindex="-1"></a>        log_ml_estimate <span class="op">=</span> log_total_weight <span class="op">-</span> jnp.log(<span class="va">self</span>.num_particles)</span>
<span id="cb8-70"><a href="#cb8-70" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> key, (m_trs, log_normalized_weights, log_ml_estimate)</span>
<span id="cb8-71"><a href="#cb8-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-72"><a href="#cb8-72" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="bu">apply</span>(<span class="va">self</span>, key, choice_map: ChoiceMap, <span class="op">*</span>args):</span>
<span id="cb8-73"><a href="#cb8-73" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Importance sampling with custom proposal branch.</span></span>
<span id="cb8-74"><a href="#cb8-74" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="bu">len</span>(args) <span class="op">==</span> <span class="dv">2</span>:</span>
<span id="cb8-75"><a href="#cb8-75" aria-hidden="true" tabindex="-1"></a>            <span class="cf">assert</span> <span class="bu">isinstance</span>(args[<span class="dv">0</span>], <span class="bu">tuple</span>)</span>
<span id="cb8-76"><a href="#cb8-76" aria-hidden="true" tabindex="-1"></a>            <span class="cf">assert</span> <span class="bu">isinstance</span>(args[<span class="dv">1</span>], <span class="bu">tuple</span>)</span>
<span id="cb8-77"><a href="#cb8-77" aria-hidden="true" tabindex="-1"></a>            <span class="cf">assert</span> <span class="va">self</span>.proposal <span class="kw">is</span> <span class="kw">not</span> <span class="va">None</span></span>
<span id="cb8-78"><a href="#cb8-78" aria-hidden="true" tabindex="-1"></a>            model_args <span class="op">=</span> args[<span class="dv">0</span>]</span>
<span id="cb8-79"><a href="#cb8-79" aria-hidden="true" tabindex="-1"></a>            proposal_args <span class="op">=</span> args[<span class="dv">1</span>]</span>
<span id="cb8-80"><a href="#cb8-80" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">self</span>._proposal_importance_sampling(</span>
<span id="cb8-81"><a href="#cb8-81" aria-hidden="true" tabindex="-1"></a>                key, choice_map, model_args, proposal_args</span>
<span id="cb8-82"><a href="#cb8-82" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb8-83"><a href="#cb8-83" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Bootstrap importance sampling branch.</span></span>
<span id="cb8-84"><a href="#cb8-84" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb8-85"><a href="#cb8-85" aria-hidden="true" tabindex="-1"></a>            <span class="cf">assert</span> <span class="bu">isinstance</span>(args, <span class="bu">tuple</span>)</span>
<span id="cb8-86"><a href="#cb8-86" aria-hidden="true" tabindex="-1"></a>            <span class="cf">assert</span> <span class="va">self</span>.proposal <span class="kw">is</span> <span class="va">None</span></span>
<span id="cb8-87"><a href="#cb8-87" aria-hidden="true" tabindex="-1"></a>            model_args <span class="op">=</span> args[<span class="dv">0</span>]</span>
<span id="cb8-88"><a href="#cb8-88" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">self</span>._bootstrap_importance_sampling(key, choice_map, model_args)</span>
<span id="cb8-89"><a href="#cb8-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-90"><a href="#cb8-90" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__call__</span>(<span class="va">self</span>, key, choice_map: ChoiceMap, <span class="op">*</span>args):</span>
<span id="cb8-91"><a href="#cb8-91" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">self</span>.<span class="bu">apply</span>(key, choice_map, <span class="op">*</span>args)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Before we consider invoking this, let’s write a ground truth process which we can parametrize by the number of data points.</p>
<div class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> make_data(num_data_points):</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>    key <span class="op">=</span> jax.random.PRNGKey(<span class="dv">0</span>)</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>    noise <span class="op">=</span> <span class="fl">0.5</span> <span class="op">*</span> jax.random.normal(key, shape<span class="op">=</span>(num_data_points,))</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>    data <span class="op">=</span> np.arange(<span class="op">-</span><span class="fl">2.0</span>, <span class="fl">2.0</span>, <span class="fl">4.0</span> <span class="op">/</span> num_data_points)</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>    y <span class="op">=</span> <span class="fl">2.0</span> <span class="op">*</span> data<span class="op">**</span><span class="dv">2</span> <span class="op">+</span> <span class="fl">2.0</span> <span class="op">+</span> data<span class="op">**</span><span class="dv">3</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>    y[<span class="bu">int</span>(num_data_points <span class="op">/</span> <span class="dv">2</span>)] <span class="op">=</span> <span class="fl">20.0</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>    y[<span class="bu">int</span>(num_data_points <span class="op">/</span> <span class="dv">4</span>)] <span class="op">=</span> <span class="fl">20.0</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>    y[<span class="bu">int</span>(num_data_points <span class="op">/</span> <span class="dv">5</span>)] <span class="op">=</span> <span class="fl">20.0</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>    y <span class="op">=</span> y <span class="op">+</span> noise</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> data, y</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>data, y <span class="op">=</span> make_data(<span class="dv">100</span>)</span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>fig_data, ax_data <span class="op">=</span> plt.subplots(dpi<span class="op">=</span><span class="dv">280</span>)</span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>viz(ax_data, data, y, color<span class="op">=</span><span class="st">"blue"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="genjax_expo_0_files/figure-html/cell-9-output-1.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>observations <span class="op">=</span> genjax.choice_map(</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>    {<span class="st">"ys"</span>: genjax.vector_choice_map(genjax.choice_map({(<span class="st">"y"</span>, <span class="st">"value"</span>): y}))}</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>observations</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"></pre>
</div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="font-weight: bold">BuiltinChoiceMap</span>
└── trie
    └── <span style="font-weight: bold">Trie</span>
        └── <span style="font-weight: bold">:ys</span>
            └── <span style="font-weight: bold">VectorChoiceMap</span>
                ├── indices
                │   └── (numpy) i64[100]
                └── inner
                    └── <span style="font-weight: bold">BuiltinChoiceMap</span>
                        └── trie
                            └── <span style="font-weight: bold">Trie</span>
                                └── <span style="font-weight: bold">:y</span>
                                    └── <span style="font-weight: bold">Trie</span>
                                        └── <span style="font-weight: bold">:value</span>
                                            └── <span style="font-weight: bold">ValueChoiceMap</span>
                                                └── value
                                                    └──  f32[100]
</pre>
</div>
</div>
<p>Here, <code>VectorChoiceMap</code> communicates constraints to <code>MapCombinator</code> (as well as <code>UnfoldCombinator</code>, but that’s not featured in our model right now).</p>
<p>The indices describe, for each leaf element of the struct-of-array choice map shadowed by the <code>VectorChoiceMap</code>, what index of the <code>Map</code> invocation the value came from.</p>
<div class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>observations[<span class="st">"ys"</span>].indices</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #800080; text-decoration-color: #800080; font-weight: bold">array</span><span style="font-weight: bold">([</span> <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span>,  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>,  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span>,  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span>,  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4</span>,  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">5</span>,  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">6</span>,  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">7</span>,  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">8</span>,  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">9</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">11</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">12</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">13</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">14</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">15</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">16</span>,
       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">17</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">18</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">19</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">20</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">21</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">22</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">23</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">24</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">25</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">26</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">27</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">28</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">29</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">30</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">31</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">32</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">33</span>,
       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">34</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">35</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">36</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">37</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">38</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">39</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">40</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">41</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">42</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">43</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">44</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">45</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">46</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">47</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">48</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">49</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">50</span>,
       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">51</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">52</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">53</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">54</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">55</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">56</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">57</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">58</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">59</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">60</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">61</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">62</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">63</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">64</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">65</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">66</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">67</span>,
       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">68</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">69</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">70</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">71</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">72</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">73</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">74</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">75</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">76</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">77</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">78</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">79</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">80</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">81</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">82</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">83</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">84</span>,
       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">85</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">86</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">87</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">88</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">89</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">90</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">91</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">92</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">93</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">94</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">95</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">96</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">97</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">98</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">99</span><span style="font-weight: bold">])</span>
</pre>
</div>
</div>
<p>To invoke importance sampling, we can instantiate an instance of <code>ImportanceSampling</code>.</p>
<div class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1000 particles.</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>inf <span class="op">=</span> genjax.ImportanceSampling.new(<span class="dv">1000</span>, model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Here, because I want a convenient way to show the inference results, I’m actually going to use sampling importance resampling - allowing me to sample a single sample from the approximate posterior induced by importance sampling.</p>
<div class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>inf <span class="op">=</span> genjax.SamplingImportanceResampling.new(<span class="dv">1000</span>, model)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>inf</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"></pre>
</div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="font-weight: bold">SamplingImportanceResampling</span>
├── num_particles
│   └── (const) 1000
├── model
│   └── <span style="font-weight: bold">BuiltinGenerativeFunction</span>
│       └── source
│           └── &lt;function model&gt;
└── proposal
    └── (const) None
</pre>
</div>
</div>
<p>Let’s plot inference results using SIR to return single sample from the approximate posterior induced by importance sampling.</p>
<div class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Evaluate a polynomial at x.</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> polynomial_at_x(x, coefficients):</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>    v <span class="op">=</span> jnp.arange(<span class="bu">len</span>(coefficients))</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>    basis <span class="op">=</span> x<span class="op">**</span>v</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>    polynomial_value <span class="op">=</span> jnp.<span class="bu">sum</span>(coefficients <span class="op">*</span> basis)</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> polynomial_value</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>poly_eval <span class="op">=</span> jax.jit(jax.vmap(polynomial_at_x, in_axes<span class="op">=</span>(<span class="dv">0</span>, <span class="va">None</span>)))</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> plot_polynomial_values(ax, x, coefficients, <span class="op">**</span>kwargs):</span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>    v <span class="op">=</span> poly_eval(x, coefficients)</span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>    ax.scatter(x, v, <span class="op">**</span>kwargs)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Below, we showcase 16 runs of SIR - we highlight outlier predictions in a <code>green</code> color, and the polynomial induced by the coefficients from the posterior sample is plotted in <code>light gold</code>.</p>
<div class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Sampling importance resampling</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>inf <span class="op">=</span> genjax.sir(<span class="dv">1000</span>, model)</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>x, y <span class="op">=</span> make_data(<span class="dv">100</span>)</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>observations <span class="op">=</span> genjax.choice_map(</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>    {<span class="st">"ys"</span>: genjax.vector_choice_map(genjax.choice_map({(<span class="st">"y"</span>, <span class="st">"value"</span>): y}))}</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>jitted <span class="op">=</span> jax.jit(inf.<span class="bu">apply</span>)</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Warmup.</span></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>key, (tr, _, _) <span class="op">=</span> jitted(key, observations, (x,))</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a><span class="op">%</span>time key, (tr, _, _) <span class="op">=</span> jitted(key, observations, (x, ))</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Make plots.</span></span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>f, axes <span class="op">=</span> plt.subplots(<span class="dv">4</span>, <span class="dv">4</span>, sharex<span class="op">=</span><span class="va">True</span>, sharey<span class="op">=</span><span class="va">True</span>, dpi<span class="op">=</span><span class="dv">280</span>)</span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>f.suptitle(<span class="st">"Samples from IS approximate posterior"</span>)</span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> ax <span class="kw">in</span> axes.flatten():</span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>    key, (tr, _, _) <span class="op">=</span> jitted(key, observations, (x,))</span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a>    coefficients <span class="op">=</span> tr[<span class="st">"alpha"</span>].inner.get_retval()</span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a>    outliers <span class="op">=</span> tr[<span class="st">"ys"</span>].indices[tr[<span class="st">"ys"</span>, <span class="st">"outlier"</span>]]</span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a>    viz(ax, x, y, marker<span class="op">=</span><span class="st">"."</span>)</span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a>    viz(ax, x[outliers], y[outliers], marker<span class="op">=</span><span class="st">"."</span>, color<span class="op">=</span><span class="st">"green"</span>)</span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a>    plot_polynomial_values(ax, data, coefficients, marker<span class="op">=</span><span class="st">"."</span>, alpha<span class="op">=</span><span class="fl">0.2</span>, color<span class="op">=</span><span class="st">"gold"</span>)</span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-23"><a href="#cb15-23" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>CPU times: user 529 µs, sys: 0 ns, total: 529 µs
Wall time: 387 µs</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="genjax_expo_0_files/figure-html/cell-15-output-2.png" class="img-fluid"></p>
</div>
</div>
<p>Now, the outlier inferences aren’t the best - we’ll attempt to fix that in a moment…</p>
<p>But notice the runtime - at least for me, that feels comparable to Julia - and it makes sense, we’ve eliminated all the Python overhead in the hot inference code.</p>
<p>But that timing was utilizing the CPU - and internally importance sampling calls <code>vmap</code>, which supports multi-threading parallelism on devices which support it.</p>
<p>Let’s move on to benchmarking, and now we’ll get to compare the CPU execution to the GPU.</p>
<section id="benchmarking-importance-sampling" class="level3">
<h3 class="anchored" data-anchor-id="benchmarking-importance-sampling">Benchmarking importance sampling</h3>
<p>Later on, we’ll add ingredients to our importance sampling routine (like rejuvenation) - so here, we’ll make the benchmark code re-usable.</p>
<div class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> benchmark(key, inf, <span class="op">*</span>args, iters<span class="op">=</span><span class="dv">100</span>, device<span class="op">=</span>jax.devices()[<span class="dv">0</span>]):</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>    jitted <span class="op">=</span> jax.jit(inf, device<span class="op">=</span>device)</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>    <span class="co"># warmup</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>    key, _ <span class="op">=</span> jitted(key, <span class="op">*</span>args)</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>    times <span class="op">=</span> []</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">0</span>, iters):</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>        start <span class="op">=</span> time.time()</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>        key, v <span class="op">=</span> jitted(key, <span class="op">*</span>args)</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>        v.block_until_ready()  <span class="co"># force</span></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>        stop <span class="op">=</span> time.time()</span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>        times.append(stop <span class="op">-</span> start)</span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> key, np.array(times)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1000 particles.</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>inf <span class="op">=</span> genjax.ImportanceSampling.new(<span class="dv">1000</span>, model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Below is our complete benchmark code - which runs our variant of inference on both CPU and GPU devices, while scaling up the number of datapoints.</p>
<div class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Benchmark function.</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> _importance_sampling(key, <span class="op">*</span>args):</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>    inf <span class="op">=</span> genjax.ImportanceSampling.new(<span class="dv">1000</span>, model)</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>    key, (trs, _, _) <span class="op">=</span> inf.<span class="bu">apply</span>(key, <span class="op">*</span>args)</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>    score <span class="op">=</span> jnp.mean(trs.get_score())</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> key, score</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> benchmark_is(key, num_data_points, device<span class="op">=</span>jax.devices()[<span class="dv">0</span>]):</span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>    x, y <span class="op">=</span> make_data(num_data_points)</span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>    observations <span class="op">=</span> genjax.choice_map(</span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>        {<span class="st">"ys"</span>: genjax.vector_choice_map(genjax.choice_map({(<span class="st">"y"</span>, <span class="st">"value"</span>): y}))}</span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>    key, times <span class="op">=</span> benchmark(key, _importance_sampling, observations, (x,), device<span class="op">=</span>device)</span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> key, times</span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Convenience which allows us to scale data and get times back</span></span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a><span class="co"># for execution on a specific JAX-managed device.</span></span>
<span id="cb19-20"><a href="#cb19-20" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> test_device(key, data_counts, device):</span>
<span id="cb19-21"><a href="#cb19-21" aria-hidden="true" tabindex="-1"></a>    times <span class="op">=</span> []</span>
<span id="cb19-22"><a href="#cb19-22" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> data_count <span class="kw">in</span> data_counts:</span>
<span id="cb19-23"><a href="#cb19-23" aria-hidden="true" tabindex="-1"></a>        key, ts <span class="op">=</span> <span class="op">%</span>time benchmark_is(key, data_count, device<span class="op">=</span>device)</span>
<span id="cb19-24"><a href="#cb19-24" aria-hidden="true" tabindex="-1"></a>        m <span class="op">=</span> np.mean(ts)</span>
<span id="cb19-25"><a href="#cb19-25" aria-hidden="true" tabindex="-1"></a>        times.append(m)</span>
<span id="cb19-26"><a href="#cb19-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-27"><a href="#cb19-27" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> key, np.array(times)</span>
<span id="cb19-28"><a href="#cb19-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-29"><a href="#cb19-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-30"><a href="#cb19-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Benchmarking.</span></span>
<span id="cb19-31"><a href="#cb19-31" aria-hidden="true" tabindex="-1"></a>data_counts <span class="op">=</span> [<span class="dv">100</span>, <span class="dv">200</span>, <span class="dv">300</span>, <span class="dv">400</span>, <span class="dv">500</span>, <span class="dv">600</span>]</span>
<span id="cb19-32"><a href="#cb19-32" aria-hidden="true" tabindex="-1"></a>f, axes <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">2</span>, sharey<span class="op">=</span><span class="va">True</span>, dpi<span class="op">=</span><span class="dv">280</span>)</span>
<span id="cb19-33"><a href="#cb19-33" aria-hidden="true" tabindex="-1"></a>cpu_ax <span class="op">=</span> axes[<span class="dv">0</span>]</span>
<span id="cb19-34"><a href="#cb19-34" aria-hidden="true" tabindex="-1"></a>gpu_ax <span class="op">=</span> axes[<span class="dv">1</span>]</span>
<span id="cb19-35"><a href="#cb19-35" aria-hidden="true" tabindex="-1"></a>cpu_ax.set_ylabel(<span class="st">"Time (s)"</span>)</span>
<span id="cb19-36"><a href="#cb19-36" aria-hidden="true" tabindex="-1"></a>cpu_ax.set_xlabel(<span class="st">"Num. data points"</span>)</span>
<span id="cb19-37"><a href="#cb19-37" aria-hidden="true" tabindex="-1"></a>gpu_ax.set_xlabel(<span class="st">"Num. data points"</span>)</span>
<span id="cb19-38"><a href="#cb19-38" aria-hidden="true" tabindex="-1"></a>key, cpu_times <span class="op">=</span> test_device(key, data_counts, cpu_device)</span>
<span id="cb19-39"><a href="#cb19-39" aria-hidden="true" tabindex="-1"></a>key, gpu_times <span class="op">=</span> test_device(key, data_counts, gpu_device)</span>
<span id="cb19-40"><a href="#cb19-40" aria-hidden="true" tabindex="-1"></a>cpu_ax.scatter(data_counts, cpu_times)</span>
<span id="cb19-41"><a href="#cb19-41" aria-hidden="true" tabindex="-1"></a>gpu_ax.scatter(data_counts, gpu_times)</span>
<span id="cb19-42"><a href="#cb19-42" aria-hidden="true" tabindex="-1"></a>f.suptitle(<span class="st">"IS Runtime (CPU vs. GPU)"</span>)</span>
<span id="cb19-43"><a href="#cb19-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-44"><a href="#cb19-44" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>CPU times: user 8.65 s, sys: 552 ms, total: 9.2 s
Wall time: 3.66 s
CPU times: user 16.8 s, sys: 659 ms, total: 17.4 s
Wall time: 4.93 s
CPU times: user 24.3 s, sys: 751 ms, total: 25.1 s
Wall time: 6.26 s
CPU times: user 31.4 s, sys: 570 ms, total: 31.9 s
Wall time: 7.56 s
CPU times: user 37.5 s, sys: 967 ms, total: 38.5 s
Wall time: 9 s
CPU times: user 46.1 s, sys: 1.03 s, total: 47.1 s
Wall time: 10.7 s
CPU times: user 3.05 s, sys: 84 ms, total: 3.13 s
Wall time: 1.98 s
CPU times: user 3.41 s, sys: 116 ms, total: 3.52 s
Wall time: 2.17 s
CPU times: user 3.71 s, sys: 76.2 ms, total: 3.79 s
Wall time: 2.33 s
CPU times: user 3.72 s, sys: 168 ms, total: 3.89 s
Wall time: 2.46 s
CPU times: user 3.91 s, sys: 108 ms, total: 4.02 s
Wall time: 2.61 s
CPU times: user 3.95 s, sys: 126 ms, total: 4.07 s
Wall time: 2.61 s</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="genjax_expo_0_files/figure-html/cell-18-output-2.png" class="img-fluid"></p>
</div>
</div>
<p>Notice in the plot above - parallelization keeps the compute time constant! That’s what we expect with embarrassingly parallel computations, and in this case - it’s extremely beneficial.</p>
</section>
</section>
<section id="interim-ad-interfaces-in-genjax" class="level2">
<h2 class="anchored" data-anchor-id="interim-ad-interfaces-in-genjax">Interim: AD interfaces in GenJAX</h2>
<p>Let’s also consider the AD interfaces – from importance sampling, we might want to consider rejuvenation moves which utilize gradients (like MALA).</p>
<p>In GenJAX, the interfaces are slightly different than Gen.jl – GenJAX automatically defines a function called <code>unzip</code> for any generative function which implements <code>assess</code>.</p>
<div class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>key, scorer, returner <span class="op">=</span> model.unzip(key, genjax.EmptyChoiceMap)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><code>model.unzip</code> requires a PRNG key and fixed choice map - and returns two functions.</p>
<p>The first <code>scorer</code> function accepts a choice map and arguments and returns a <code>score</code> (computed using <code>assess</code>). It’s a convenient function to apply <code>jax.grad</code> to.</p>
<p>The second <code>returner</code> function accepts a choice map and arguments and returns the <code>retval</code> (again computed using <code>assess</code>). It provides an interface to compute gradients with respect to the return value of the generative function.</p>
<p>At least – that’s how it should be! For now, JAX has a few sharp edges around differentiating functions with respect to <code>Pytree</code> arguments. So the signatures of <code>scorer</code> and <code>returner</code> are:</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> scorer(differentiable, nondifferentiable):</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>    ...</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> returner(differentiable, nondifferentiable):</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>    ...</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>GenJAX exports a few utilities which allows you to break <code>Pytree</code> instances (like choice maps) into components - the differentiable ones allowed gradients to flow, the non-differentiable ones (like integers, or booleans) do not.</p>
<p>We won’t we be looking at these lowest level interfaces today – but I’ll just mention that <code>choice_grad</code> is an automatically defined method on generative functions which utilizes the lowest level interfaces to provide support for similar functionality to <code>Gen.jl</code>:</p>
<div class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># A higher-level gradient API - it relies upon `unzip`,</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="co"># but provides convenient access to first-order gradients.</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> choice_grad(<span class="va">self</span>, key, trace, selection):</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>    fixed <span class="op">=</span> selection.complement().<span class="bu">filter</span>(trace.strip())</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>    evaluation_point <span class="op">=</span> selection.<span class="bu">filter</span>(trace.strip())</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>    key, scorer, _ <span class="op">=</span> <span class="va">self</span>.unzip(key, fixed)</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>    grad, nograd <span class="op">=</span> tree_grad_split(</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>        (evaluation_point, trace.get_args()),</span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>    choice_gradient_tree, _ <span class="op">=</span> jax.grad(scorer)(grad, nograd)</span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> key, choice_gradient_tree</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Note how this implementation of the gradient interfaces explicitly breaks the compositionality which Gen defines for <code>choice_gradients</code> and <code>argument_gradients</code>!</p>
<p>The gradient interfaces above conform to JAX typical idioms (setting up functions and <code>jax.grad</code>ing them). This also provides support for higher-order AD.</p>
<p>It’s a pragmatic decision - but ultimately one I’m unsettled by. I’d love to discuss this design decision further.</p>
<section id="implementing-map" class="level3">
<h3 class="anchored" data-anchor-id="implementing-map">Implementing MAP</h3>
<p>Here’s a rough version “always accept” MAP using the gradient interfaces (there’s some slight deviations between this code and the standard library version, for pedagogical reasons).</p>
<div class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="at">@dataclasses.dataclass</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> MapUpdate(genjax.Pytree):</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>    selection: Selection</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>    tau: FloatArray</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> flatten(<span class="va">self</span>):</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> (<span class="va">self</span>.tau,), (<span class="va">self</span>.selection,)</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="bu">apply</span>(<span class="va">self</span>, key, trace):</span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>        args <span class="op">=</span> trace.get_args()</span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>        gen_fn <span class="op">=</span> trace.get_gen_fn()</span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>        key, forward_gradient_trie <span class="op">=</span> gen_fn.choice_grad(key, trace, <span class="va">self</span>.selection)</span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a>        forward_values <span class="op">=</span> <span class="va">self</span>.selection.<span class="bu">filter</span>(trace.strip())</span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a>        forward_values <span class="op">=</span> forward_values.strip()</span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a>        forward_values <span class="op">=</span> jtu.tree_map(</span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a>            <span class="kw">lambda</span> v1, v2: v1 <span class="op">+</span> <span class="va">self</span>.tau <span class="op">*</span> v2,</span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a>            forward_values,</span>
<span id="cb24-18"><a href="#cb24-18" aria-hidden="true" tabindex="-1"></a>            forward_gradient_trie,</span>
<span id="cb24-19"><a href="#cb24-19" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb24-20"><a href="#cb24-20" aria-hidden="true" tabindex="-1"></a>        key, (_, _, new_trace, _) <span class="op">=</span> gen_fn.update(key, trace, forward_values, args)</span>
<span id="cb24-21"><a href="#cb24-21" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> key, (new_trace, <span class="va">True</span>)</span>
<span id="cb24-22"><a href="#cb24-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-23"><a href="#cb24-23" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__call__</span>(<span class="va">self</span>, key, trace):</span>
<span id="cb24-24"><a href="#cb24-24" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">self</span>.<span class="bu">apply</span>(key, trace)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="inference-v1-map-initialization-mhmala-chain" class="level2">
<h2 class="anchored" data-anchor-id="inference-v1-map-initialization-mhmala-chain">Inference v1: MAP initialization + MH/MALA chain</h2>
<p>Let’s consider inference utilizing MAP initialization followed by MALA/MH moves.</p>
<div class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>map_move <span class="op">=</span> genjax.map_update(genjax.select([<span class="st">"alpha"</span>]), <span class="fl">5e-4</span>)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>mala_move <span class="op">=</span> genjax.mala(genjax.select([<span class="st">"alpha"</span>]), <span class="fl">5e-4</span>)</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>mala_move</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"></pre>
</div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="font-weight: bold">MetropolisAdjustedLangevinAlgorithm</span>
├── selection
│   └── <span style="font-weight: bold">BuiltinSelection</span>
│       └── trie
│           └── <span style="font-weight: bold">Trie</span>
│               └── <span style="font-weight: bold">:alpha</span>
│                   └── <span style="font-weight: bold">AllSelection</span>
└── tau
    └── (const) 0.0005
</pre>
</div>
</div>
<p>For MH, we’ll define a proposal which targets the <code>"outlier"</code> random variable.</p>
<div class="cell" data-execution_count="22">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="at">@genjax.gen</span>(genjax.Map, in_axes<span class="op">=</span>(<span class="dv">0</span>,))</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> proposal_kernel(x):</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>    is_outlier <span class="op">=</span> trace(<span class="st">"outlier"</span>, genjax.Bernoulli)(<span class="fl">0.1</span>)</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> is_outlier</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a><span class="at">@genjax.gen</span></span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> proposal(chm, x):</span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>    v <span class="op">=</span> trace(<span class="st">"ys"</span>, proposal_kernel)(x)</span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> v</span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a>mh_move <span class="op">=</span> genjax.mh(genjax.select([(<span class="st">"ys"</span>, <span class="st">"outlier"</span>)]), proposal)</span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a>mh_move</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"></pre>
</div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="font-weight: bold">MetropolisHastings</span>
├── selection
│   └── <span style="font-weight: bold">BuiltinSelection</span>
│       └── trie
│           └── <span style="font-weight: bold">Trie</span>
│               └── <span style="font-weight: bold">:ys</span>
│                   └── <span style="font-weight: bold">Trie</span>
│                       └── <span style="font-weight: bold">:outlier</span>
│                           └── <span style="font-weight: bold">AllSelection</span>
└── proposal
    └── <span style="font-weight: bold">BuiltinGenerativeFunction</span>
        └── source
            └── &lt;function proposal&gt;
</pre>
</div>
</div>
<section id="chain-idioms-in-jax" class="level3">
<h3 class="anchored" data-anchor-id="chain-idioms-in-jax">Chain idioms in JAX</h3>
<p>Now we can create two chain functions, one for the MAP initialization and one for the MALA/MH moves.</p>
<p>We’ll use <code>jax.lax.scan</code> to create chains of kernel applications. This is a control flow primitive which expresses a fold-like pattern of computation - and lowers to an efficient XLA loop nest.</p>
<p>As part of the <code>jax.lax.scan</code> call, we can return the current trace out and create a sequence – we’ll use this sequence to animate the moves below.</p>
<div class="cell" data-execution_count="23">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> map_chain(key, initial_trace, length):</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> _inner(carry, xs):</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>        key, current <span class="op">=</span> carry</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>        key, (new, _) <span class="op">=</span> map_move(key, current)</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> (key, new), new</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>    (key, new), sequence <span class="op">=</span> jax.lax.scan(</span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>        _inner, (key, initial_trace), <span class="va">None</span>, length<span class="op">=</span>length</span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> (key, new), sequence</span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> rejuv_chain(key, initial_trace, length<span class="op">=</span><span class="dv">50</span>):</span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a>    (data,) <span class="op">=</span> initial_trace.get_args()</span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> _inner(carry, xs):</span>
<span id="cb27-17"><a href="#cb27-17" aria-hidden="true" tabindex="-1"></a>        key, current <span class="op">=</span> carry</span>
<span id="cb27-18"><a href="#cb27-18" aria-hidden="true" tabindex="-1"></a>        key, (new, _) <span class="op">=</span> mh_move(key, current, (data,))</span>
<span id="cb27-19"><a href="#cb27-19" aria-hidden="true" tabindex="-1"></a>        key, (new, _) <span class="op">=</span> mala_move(key, new)</span>
<span id="cb27-20"><a href="#cb27-20" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Here, we pass the x-data - as a convenient way</span></span>
<span id="cb27-21"><a href="#cb27-21" aria-hidden="true" tabindex="-1"></a>        <span class="co"># to use the broadcast axis length in the proposal.</span></span>
<span id="cb27-22"><a href="#cb27-22" aria-hidden="true" tabindex="-1"></a>        key, (new, _) <span class="op">=</span> mh_move(key, new, (data,))</span>
<span id="cb27-23"><a href="#cb27-23" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> (key, new), new</span>
<span id="cb27-24"><a href="#cb27-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-25"><a href="#cb27-25" aria-hidden="true" tabindex="-1"></a>    (key, new), sequence <span class="op">=</span> jax.lax.scan(</span>
<span id="cb27-26"><a href="#cb27-26" aria-hidden="true" tabindex="-1"></a>        _inner, (key, initial_trace), <span class="va">None</span>, length<span class="op">=</span>length</span>
<span id="cb27-27"><a href="#cb27-27" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb27-28"><a href="#cb27-28" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> (key, new), sequence</span>
<span id="cb27-29"><a href="#cb27-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-30"><a href="#cb27-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-31"><a href="#cb27-31" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> mixed_inf(key, initial_trace, length<span class="op">=</span><span class="dv">50</span>):</span>
<span id="cb27-32"><a href="#cb27-32" aria-hidden="true" tabindex="-1"></a>    (key, new), map_sequence <span class="op">=</span> map_chain(key, initial_trace, length)</span>
<span id="cb27-33"><a href="#cb27-33" aria-hidden="true" tabindex="-1"></a>    (key, new), rejuv_sequence <span class="op">=</span> rejuv_chain(key, new, length)</span>
<span id="cb27-34"><a href="#cb27-34" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> (key, new), (map_sequence, rejuv_sequence)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Let’s construct an animation using <code>mixed_inf</code> (MAP + MALA/MH).</p>
<p>First, we’ll get the sequence of traces from inference.</p>
<div class="cell" data-execution_count="24">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Regenerate our sample curve with 100 points.</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>x, y <span class="op">=</span> make_data(<span class="dv">100</span>)</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Run MAP, followed by MALA/MH chain.</span></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> run_mixed(key, x, y, device<span class="op">=</span>jax.devices()[<span class="dv">0</span>]):</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>    observations <span class="op">=</span> genjax.choice_map(</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>        {<span class="st">"ys"</span>: genjax.vector_choice_map(genjax.choice_map({(<span class="st">"y"</span>, <span class="st">"value"</span>): y}))}</span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>    key, (_, initial) <span class="op">=</span> jax.jit(model.importance)(key, observations, (x,))</span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>    (key, _), (map_s, rejuv_s) <span class="op">=</span> mixed_inf(key, initial)</span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> key, (map_s, rejuv_s)</span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the two update sequences.</span></span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a>key, (map_s, rejuv_s) <span class="op">=</span> jax.jit(run_mixed)(key, x, y)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Then, we can construct an animation showing traces from the two chains wiggle into place.</p>
<p>(The blue line should be a scatter plot! But I couldn’t figure out to make this work with the <code>matplotlib.animation</code> functionality)</p>
<div class="cell" data-execution_count="25">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="op">%</span>matplotlib inline</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a><span class="co"># create a figure and axes</span></span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>f, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">6</span>, <span class="dv">6</span>))</span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a><span class="co"># set up the subplots as needed</span></span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a>ax.set_xlim((<span class="op">-</span><span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a>ax.set_ylim((<span class="dv">0</span>, <span class="dv">50</span>))</span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">"Data"</span>)</span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="st">"Predicted"</span>)</span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true" tabindex="-1"></a><span class="co"># create objects that will change in the animation. These are</span></span>
<span id="cb29-17"><a href="#cb29-17" aria-hidden="true" tabindex="-1"></a><span class="co"># initially empty, and will be given new values for each frame</span></span>
<span id="cb29-18"><a href="#cb29-18" aria-hidden="true" tabindex="-1"></a><span class="co"># in the animation.</span></span>
<span id="cb29-19"><a href="#cb29-19" aria-hidden="true" tabindex="-1"></a>txt_title <span class="op">=</span> ax.set_title(<span class="st">""</span>)</span>
<span id="cb29-20"><a href="#cb29-20" aria-hidden="true" tabindex="-1"></a>ground_truth <span class="op">=</span> ax.scatter(</span>
<span id="cb29-21"><a href="#cb29-21" aria-hidden="true" tabindex="-1"></a>    x,</span>
<span id="cb29-22"><a href="#cb29-22" aria-hidden="true" tabindex="-1"></a>    y,</span>
<span id="cb29-23"><a href="#cb29-23" aria-hidden="true" tabindex="-1"></a>    cmap<span class="op">=</span><span class="st">"viridis"</span>,</span>
<span id="cb29-24"><a href="#cb29-24" aria-hidden="true" tabindex="-1"></a>)  <span class="co"># ax.plot returns a list of 2D line objects</span></span>
<span id="cb29-25"><a href="#cb29-25" aria-hidden="true" tabindex="-1"></a>(prediction,) <span class="op">=</span> ax.plot([], [], <span class="st">"gold"</span>, lw<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb29-26"><a href="#cb29-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-27"><a href="#cb29-27" aria-hidden="true" tabindex="-1"></a><span class="co"># animation function. This is called sequentially</span></span>
<span id="cb29-28"><a href="#cb29-28" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> drawframe(n):</span>
<span id="cb29-29"><a href="#cb29-29" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> n <span class="op">&lt;</span> <span class="dv">50</span>:</span>
<span id="cb29-30"><a href="#cb29-30" aria-hidden="true" tabindex="-1"></a>        coefficients <span class="op">=</span> map_s[<span class="st">"alpha"</span>].inner.get_leaf_value()</span>
<span id="cb29-31"><a href="#cb29-31" aria-hidden="true" tabindex="-1"></a>        coefficients <span class="op">=</span> coefficients[n, :]</span>
<span id="cb29-32"><a href="#cb29-32" aria-hidden="true" tabindex="-1"></a>        outliers <span class="op">=</span> map_s[<span class="st">"ys"</span>, <span class="st">"outlier"</span>]</span>
<span id="cb29-33"><a href="#cb29-33" aria-hidden="true" tabindex="-1"></a>        outliers <span class="op">=</span> outliers[n, :]</span>
<span id="cb29-34"><a href="#cb29-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-35"><a href="#cb29-35" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb29-36"><a href="#cb29-36" aria-hidden="true" tabindex="-1"></a>        k <span class="op">=</span> n <span class="op">-</span> <span class="dv">50</span></span>
<span id="cb29-37"><a href="#cb29-37" aria-hidden="true" tabindex="-1"></a>        coefficients <span class="op">=</span> rejuv_s[<span class="st">"alpha"</span>].inner.get_leaf_value()</span>
<span id="cb29-38"><a href="#cb29-38" aria-hidden="true" tabindex="-1"></a>        coefficients <span class="op">=</span> coefficients[n, :]</span>
<span id="cb29-39"><a href="#cb29-39" aria-hidden="true" tabindex="-1"></a>        outliers <span class="op">=</span> rejuv_s[<span class="st">"ys"</span>, <span class="st">"outlier"</span>]</span>
<span id="cb29-40"><a href="#cb29-40" aria-hidden="true" tabindex="-1"></a>        outliers <span class="op">=</span> outliers[n, :]</span>
<span id="cb29-41"><a href="#cb29-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-42"><a href="#cb29-42" aria-hidden="true" tabindex="-1"></a>    v <span class="op">=</span> poly_eval(x, coefficients)</span>
<span id="cb29-43"><a href="#cb29-43" aria-hidden="true" tabindex="-1"></a>    prediction.set_data(x, v)</span>
<span id="cb29-44"><a href="#cb29-44" aria-hidden="true" tabindex="-1"></a>    data <span class="op">=</span> np.vstack((x, y)).T</span>
<span id="cb29-45"><a href="#cb29-45" aria-hidden="true" tabindex="-1"></a>    ground_truth.set_offsets(data)</span>
<span id="cb29-46"><a href="#cb29-46" aria-hidden="true" tabindex="-1"></a>    ground_truth.set_array(outliers)</span>
<span id="cb29-47"><a href="#cb29-47" aria-hidden="true" tabindex="-1"></a>    ax.set_xlabel(<span class="st">"Data"</span>)</span>
<span id="cb29-48"><a href="#cb29-48" aria-hidden="true" tabindex="-1"></a>    ax.set_ylabel(<span class="st">"Predicted"</span>)</span>
<span id="cb29-49"><a href="#cb29-49" aria-hidden="true" tabindex="-1"></a>    txt_title.set_text(<span class="st">"(MAP + MALA/MH Chain) Frame = </span><span class="sc">{0:4d}</span><span class="st">"</span>.<span class="bu">format</span>(n))</span>
<span id="cb29-50"><a href="#cb29-50" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> (ground_truth, prediction)</span>
<span id="cb29-51"><a href="#cb29-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-52"><a href="#cb29-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-53"><a href="#cb29-53" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> matplotlib <span class="im">import</span> animation</span>
<span id="cb29-54"><a href="#cb29-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-55"><a href="#cb29-55" aria-hidden="true" tabindex="-1"></a><span class="co"># blit=True re-draws only the parts that have changed.</span></span>
<span id="cb29-56"><a href="#cb29-56" aria-hidden="true" tabindex="-1"></a>anim <span class="op">=</span> animation.FuncAnimation(f, drawframe, frames<span class="op">=</span><span class="dv">100</span>, interval<span class="op">=</span><span class="dv">50</span>, blit<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb29-57"><a href="#cb29-57" aria-hidden="true" tabindex="-1"></a>plt.close()</span>
<span id="cb29-58"><a href="#cb29-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-59"><a href="#cb29-59" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> IPython.display <span class="im">import</span> HTML</span>
<span id="cb29-60"><a href="#cb29-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-61"><a href="#cb29-61" aria-hidden="true" tabindex="-1"></a>HTML(anim.to_html5_video())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>/tmp/ipykernel_42331/3474476441.py:20: UserWarning: No data for colormapping provided via 'c'. Parameters 'cmap' will be ignored
  ground_truth = ax.scatter(</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="25">
<video width="600" height="600" controls="" autoplay="" loop="">
  <source type="video/mp4" src="data:video/mp4;base64,AAAAIGZ0eXBNNFYgAAACAE00ViBpc29taXNvMmF2YzEAAAAIZnJlZQAA3hBtZGF0AAACrwYF//+r
3EXpvebZSLeWLNgg2SPu73gyNjQgLSBjb3JlIDE2MyByMzA2MCA1ZGI2YWE2IC0gSC4yNjQvTVBF
Ry00IEFWQyBjb2RlYyAtIENvcHlsZWZ0IDIwMDMtMjAyMSAtIGh0dHA6Ly93d3cudmlkZW9sYW4u
b3JnL3gyNjQuaHRtbCAtIG9wdGlvbnM6IGNhYmFjPTEgcmVmPTMgZGVibG9jaz0xOjA6MCBhbmFs
eXNlPTB4MzoweDExMyBtZT1oZXggc3VibWU9NyBwc3k9MSBwc3lfcmQ9MS4wMDowLjAwIG1peGVk
X3JlZj0xIG1lX3JhbmdlPTE2IGNocm9tYV9tZT0xIHRyZWxsaXM9MSA4eDhkY3Q9MSBjcW09MCBk
ZWFkem9uZT0yMSwxMSBmYXN0X3Bza2lwPTEgY2hyb21hX3FwX29mZnNldD0tMiB0aHJlYWRzPTE5
IGxvb2thaGVhZF90aHJlYWRzPTMgc2xpY2VkX3RocmVhZHM9MCBucj0wIGRlY2ltYXRlPTEgaW50
ZXJsYWNlZD0wIGJsdXJheV9jb21wYXQ9MCBjb25zdHJhaW5lZF9pbnRyYT0wIGJmcmFtZXM9MyBi
X3B5cmFtaWQ9MiBiX2FkYXB0PTEgYl9iaWFzPTAgZGlyZWN0PTEgd2VpZ2h0Yj0xIG9wZW5fZ29w
PTAgd2VpZ2h0cD0yIGtleWludD0yNTAga2V5aW50X21pbj0yMCBzY2VuZWN1dD00MCBpbnRyYV9y
ZWZyZXNoPTAgcmNfbG9va2FoZWFkPTQwIHJjPWNyZiBtYnRyZWU9MSBjcmY9MjMuMCBxY29tcD0w
LjYwIHFwbWluPTAgcXBtYXg9NjkgcXBzdGVwPTQgaXBfcmF0aW89MS40MCBhcT0xOjEuMDAAgAAA
L6ZliIQAM//+9uy+BTX9n9CXFJ/9uOy5WBeREHwxPXWOAAADAAADAAAGibtKaDbK7G7oAAADA4wE
yNlnx8ELG83+AMrTj+7Woy5O8Lx8oZesOwrFybKKLygTJn3dPm24diISm0MaJZgzd+BXSjW+d+ph
zMNz8A4+V+R1PKhRhFDHR8O5PZ2bApwk24p6koJCLDjKGCFy6ZkDb69Kvb7nPdUrdTflwElTyMMW
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
ABx1dWlka2hA8l8kT8W6OaUbzwMj8wAAAAAAAAAYc3R0cwAAAAAAAAABAAAAZAAAAgAAAAAUc3Rz
cwAAAAAAAAABAAAAAQAAAxhjdHRzAAAAAAAAAGEAAAABAAAEAAAAAAEAAAoAAAAAAQAABAAAAAAB
AAAAAAAAAAEAAAIAAAAAAQAACgAAAAABAAAEAAAAAAEAAAAAAAAAAQAAAgAAAAABAAAKAAAAAAEA
AAQAAAAAAQAAAAAAAAABAAACAAAAAAEAAAoAAAAAAQAABAAAAAABAAAAAAAAAAEAAAIAAAAAAQAA
BgAAAAABAAACAAAAAAEAAAYAAAAAAQAAAgAAAAABAAAGAAAAAAEAAAIAAAAAAQAABAAAAAABAAAG
AAAAAAEAAAIAAAAAAQAABgAAAAABAAACAAAAAAEAAAYAAAAAAQAAAgAAAAABAAAGAAAAAAEAAAIA
AAAAAQAABAAAAAABAAAIAAAAAAIAAAIAAAAAAQAACAAAAAACAAACAAAAAAEAAAYAAAAAAQAAAgAA
AAABAAAIAAAAAAIAAAIAAAAAAQAACgAAAAABAAAEAAAAAAEAAAAAAAAAAQAAAgAAAAABAAAGAAAA
AAEAAAIAAAAAAQAACgAAAAABAAAEAAAAAAEAAAAAAAAAAQAAAgAAAAABAAAKAAAAAAEAAAQAAAAA
AQAAAAAAAAABAAACAAAAAAEAAAoAAAAAAQAABAAAAAABAAAAAAAAAAEAAAIAAAAAAQAACgAAAAAB
AAAEAAAAAAEAAAAAAAAAAQAAAgAAAAABAAAKAAAAAAEAAAQAAAAAAQAAAAAAAAABAAACAAAAAAEA
AAoAAAAAAQAABAAAAAABAAAAAAAAAAEAAAIAAAAAAQAACgAAAAABAAAEAAAAAAEAAAAAAAAAAQAA
AgAAAAABAAAKAAAAAAEAAAQAAAAAAQAAAAAAAAABAAACAAAAAAEAAAoAAAAAAQAABAAAAAABAAAA
AAAAAAEAAAIAAAAAAQAACgAAAAABAAAEAAAAAAEAAAAAAAAAAQAAAgAAAAABAAAKAAAAAAEAAAQA
AAAAAQAAAAAAAAABAAACAAAAAAEAAAoAAAAAAQAABAAAAAABAAAAAAAAAAEAAAIAAAAAAQAABgAA
AAABAAACAAAAABxzdHNjAAAAAAAAAAEAAAABAAAAZAAAAAEAAAGkc3RzegAAAAAAAAAAAAAAZAAA
Ml0AAAmbAAAFqQAAAPAAAAMkAAAFJwAAAnAAAAMXAAACkgAABMMAAAFiAAAB0wAAAWkAAAQcAAAB
VQAAAM4AAACrAAADggAAAKsAAAPrAAAAlwAABCMAAADZAAADPQAABRQAAADyAAAE/wAAAPsAAAWI
AAAA/wAABnQAAAD3AAAEjwAAB2IAAAGkAAABDAAAB2sAAAFiAAAAtAAABsQAAAByAAAH2gAAARoA
AAB8AAAJAAAAAcYAAACBAAAAjgAABxEAAAB7AAAA4QAAAF8AAABRAAAAUwAAAHcAAABgAAAAYQAA
AFsAAAC4AAAAZAAAAF0AAABOAAAAkwAAAFEAAABQAAAAXgAAAHMAAABTAAAAUwAAAE0AAAC1AAAA
VwAAAEgAAABNAAAAZwAAAF0AAABcAAAAVQAAAMoAAABjAAAAXAAAAFEAAACNAAAAUQAAAE8AAABg
AAAAdQAAAFAAAABVAAAAUQAAAJMAAABSAAAASAAAAE8AAABkAAAAXQAAAGQAAABWAAAAXAAAAFQA
AAAUc3RjbwAAAAAAAAABAAAAMAAAAGJ1ZHRhAAAAWm1ldGEAAAAAAAAAIWhkbHIAAAAAAAAAAG1k
aXJhcHBsAAAAAAAAAAAAAAAALWlsc3QAAAAlqXRvbwAAAB1kYXRhAAAAAQAAAABMYXZmNTguNzYu
MTAw
">
  Your browser does not support the video tag.
</video>
</div>
</div>
</section>
<section id="benchmarking-map-malamh" class="level3">
<h3 class="anchored" data-anchor-id="benchmarking-map-malamh">Benchmarking MAP + MALA/MH</h3>
<p>We’ll also define a benchmark function for this inference variant.</p>
<div class="cell" data-execution_count="26">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Benchmark function.</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> _mixed_inf(key, initial_trace):</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>    (key, new), _ <span class="op">=</span> mixed_inf(key, initial_trace, length<span class="op">=</span><span class="dv">50</span>)</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>    score <span class="op">=</span> new.get_score()</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> key, score</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> benchmark_mixed(key, num_data_points, device<span class="op">=</span>jax.devices()[<span class="dv">0</span>]):</span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>    x, y <span class="op">=</span> make_data(num_data_points)</span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>    observations <span class="op">=</span> genjax.choice_map(</span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a>        {<span class="st">"ys"</span>: genjax.vector_choice_map(genjax.choice_map({(<span class="st">"y"</span>, <span class="st">"value"</span>): y}))}</span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a>    key, (_, initial) <span class="op">=</span> jax.jit(model.importance)(key, observations, (x,))</span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a>    key, times <span class="op">=</span> benchmark(key, _mixed_inf, initial, device<span class="op">=</span>device)</span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> key, times</span>
<span id="cb31-16"><a href="#cb31-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-17"><a href="#cb31-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-18"><a href="#cb31-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Convenience which allows us to scale data and get times back</span></span>
<span id="cb31-19"><a href="#cb31-19" aria-hidden="true" tabindex="-1"></a><span class="co"># for execution on a specific JAX-managed device.</span></span>
<span id="cb31-20"><a href="#cb31-20" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> test_device(key, data_counts, device):</span>
<span id="cb31-21"><a href="#cb31-21" aria-hidden="true" tabindex="-1"></a>    times <span class="op">=</span> []</span>
<span id="cb31-22"><a href="#cb31-22" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> data_count <span class="kw">in</span> data_counts:</span>
<span id="cb31-23"><a href="#cb31-23" aria-hidden="true" tabindex="-1"></a>        key, ts <span class="op">=</span> <span class="op">%</span>time benchmark_mixed(key, data_count, device<span class="op">=</span>device)</span>
<span id="cb31-24"><a href="#cb31-24" aria-hidden="true" tabindex="-1"></a>        m <span class="op">=</span> np.mean(ts)</span>
<span id="cb31-25"><a href="#cb31-25" aria-hidden="true" tabindex="-1"></a>        times.append(m)</span>
<span id="cb31-26"><a href="#cb31-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-27"><a href="#cb31-27" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> key, np.array(times)</span>
<span id="cb31-28"><a href="#cb31-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-29"><a href="#cb31-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-30"><a href="#cb31-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Benchmarking.</span></span>
<span id="cb31-31"><a href="#cb31-31" aria-hidden="true" tabindex="-1"></a>data_counts <span class="op">=</span> [<span class="dv">100</span>, <span class="dv">200</span>, <span class="dv">300</span>, <span class="dv">400</span>, <span class="dv">500</span>, <span class="dv">600</span>]</span>
<span id="cb31-32"><a href="#cb31-32" aria-hidden="true" tabindex="-1"></a>f, axes <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">2</span>, sharey<span class="op">=</span><span class="va">True</span>, dpi<span class="op">=</span><span class="dv">280</span>)</span>
<span id="cb31-33"><a href="#cb31-33" aria-hidden="true" tabindex="-1"></a>cpu_ax <span class="op">=</span> axes[<span class="dv">0</span>]</span>
<span id="cb31-34"><a href="#cb31-34" aria-hidden="true" tabindex="-1"></a>gpu_ax <span class="op">=</span> axes[<span class="dv">1</span>]</span>
<span id="cb31-35"><a href="#cb31-35" aria-hidden="true" tabindex="-1"></a>cpu_ax.set_ylabel(<span class="st">"Time (s)"</span>)</span>
<span id="cb31-36"><a href="#cb31-36" aria-hidden="true" tabindex="-1"></a>cpu_ax.set_xlabel(<span class="st">"Num. data points"</span>)</span>
<span id="cb31-37"><a href="#cb31-37" aria-hidden="true" tabindex="-1"></a>gpu_ax.set_xlabel(<span class="st">"Num. data points"</span>)</span>
<span id="cb31-38"><a href="#cb31-38" aria-hidden="true" tabindex="-1"></a>key, cpu_times <span class="op">=</span> test_device(key, data_counts, cpu_device)</span>
<span id="cb31-39"><a href="#cb31-39" aria-hidden="true" tabindex="-1"></a>key, gpu_times <span class="op">=</span> test_device(key, data_counts, gpu_device)</span>
<span id="cb31-40"><a href="#cb31-40" aria-hidden="true" tabindex="-1"></a>cpu_ax.scatter(data_counts, cpu_times)</span>
<span id="cb31-41"><a href="#cb31-41" aria-hidden="true" tabindex="-1"></a>gpu_ax.scatter(data_counts, gpu_times)</span>
<span id="cb31-42"><a href="#cb31-42" aria-hidden="true" tabindex="-1"></a>f.suptitle(<span class="st">"MAP + MALA/MH Runtime (CPU vs. GPU)"</span>)</span>
<span id="cb31-43"><a href="#cb31-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-44"><a href="#cb31-44" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>CPU times: user 11 s, sys: 548 ms, total: 11.6 s
Wall time: 9.83 s
CPU times: user 10.7 s, sys: 633 ms, total: 11.4 s
Wall time: 11.3 s
CPU times: user 11.5 s, sys: 830 ms, total: 12.3 s
Wall time: 12.3 s
CPU times: user 12.9 s, sys: 941 ms, total: 13.9 s
Wall time: 13.8 s
CPU times: user 13.9 s, sys: 981 ms, total: 14.9 s
Wall time: 14.9 s
CPU times: user 14.9 s, sys: 1.1 s, total: 16 s
Wall time: 15.9 s
CPU times: user 17.7 s, sys: 2.34 s, total: 20 s
Wall time: 14.3 s
CPU times: user 18.2 s, sys: 2.36 s, total: 20.5 s
Wall time: 13.6 s
CPU times: user 20.4 s, sys: 2.67 s, total: 23.1 s
Wall time: 15.5 s
CPU times: user 21 s, sys: 3.03 s, total: 24.1 s
Wall time: 16.3 s
CPU times: user 22.4 s, sys: 2.93 s, total: 25.4 s
Wall time: 17.9 s
CPU times: user 23.1 s, sys: 2.87 s, total: 26 s
Wall time: 18.6 s</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="genjax_expo_0_files/figure-html/cell-27-output-2.png" class="img-fluid"></p>
</div>
</div>
</section>
</section>
<section id="inference-v2-importance-sampling-with-mhmala-rejuvenation" class="level2">
<h2 class="anchored" data-anchor-id="inference-v2-importance-sampling-with-mhmala-rejuvenation">Inference v2: Importance sampling with MH/MALA rejuvenation</h2>
<p>We can lift the previous kernel chain functions to map across the particle collection returned by importance sampling using <code>jax.vmap</code></p>
<div class="cell" data-execution_count="27">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Sampling importance resampling w/ MALA/MH rejuvenation.</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> sir_rejuv(key, <span class="op">*</span>args):</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>    inf <span class="op">=</span> genjax.ImportanceSampling.new(<span class="dv">1000</span>, model)</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>    key, (trs, lnw, lmle) <span class="op">=</span> inf.<span class="bu">apply</span>(key, <span class="op">*</span>args)</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>    key, sub_keys <span class="op">=</span> genjax.slash(key, <span class="dv">1000</span>)</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>    (_, new), _ <span class="op">=</span> jax.vmap(rejuv_chain, in_axes<span class="op">=</span>(<span class="dv">0</span>, <span class="dv">0</span>))(sub_keys, trs)</span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>    key, sub_key <span class="op">=</span> genjax.slash(key, <span class="dv">1</span>)</span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>    ind <span class="op">=</span> jax.random.categorical(sub_key, lnw)</span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a>    tr <span class="op">=</span> jtu.tree_map(<span class="kw">lambda</span> v: v[ind], trs)</span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> key, tr</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We can re-use our earlier plotting recipe.</p>
<div class="cell" data-execution_count="28">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Sampling importance resampling</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>x, y <span class="op">=</span> make_data(<span class="dv">100</span>)</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>observations <span class="op">=</span> genjax.choice_map(</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>    {<span class="st">"ys"</span>: genjax.vector_choice_map(genjax.choice_map({(<span class="st">"y"</span>, <span class="st">"value"</span>): y}))}</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>jitted <span class="op">=</span> jax.jit(sir_rejuv)</span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Warmup.</span></span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a>key, tr <span class="op">=</span> jitted(key, observations, (x,))</span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a><span class="op">%</span>time key, tr <span class="op">=</span> jitted(key, observations, (x, ))</span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Make plots.</span></span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a>f, axes <span class="op">=</span> plt.subplots(<span class="dv">4</span>, <span class="dv">4</span>, sharex<span class="op">=</span><span class="va">True</span>, sharey<span class="op">=</span><span class="va">True</span>, dpi<span class="op">=</span><span class="dv">280</span>)</span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a>f.suptitle(<span class="st">"Samples from (SIR w/ MH/MALA rejuv) approximate posterior"</span>)</span>
<span id="cb34-15"><a href="#cb34-15" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> ax <span class="kw">in</span> axes.flatten():</span>
<span id="cb34-16"><a href="#cb34-16" aria-hidden="true" tabindex="-1"></a>    key, tr <span class="op">=</span> jitted(key, observations, (x,))</span>
<span id="cb34-17"><a href="#cb34-17" aria-hidden="true" tabindex="-1"></a>    coefficients <span class="op">=</span> tr[<span class="st">"alpha"</span>].inner.get_retval()</span>
<span id="cb34-18"><a href="#cb34-18" aria-hidden="true" tabindex="-1"></a>    outliers <span class="op">=</span> tr[<span class="st">"ys"</span>].indices[tr[<span class="st">"ys"</span>, <span class="st">"outlier"</span>]]</span>
<span id="cb34-19"><a href="#cb34-19" aria-hidden="true" tabindex="-1"></a>    viz(ax, x, y, marker<span class="op">=</span><span class="st">"."</span>)</span>
<span id="cb34-20"><a href="#cb34-20" aria-hidden="true" tabindex="-1"></a>    viz(ax, x[outliers], y[outliers], marker<span class="op">=</span><span class="st">"."</span>, color<span class="op">=</span><span class="st">"green"</span>)</span>
<span id="cb34-21"><a href="#cb34-21" aria-hidden="true" tabindex="-1"></a>    plot_polynomial_values(ax, data, coefficients, marker<span class="op">=</span><span class="st">"."</span>, alpha<span class="op">=</span><span class="fl">0.2</span>, color<span class="op">=</span><span class="st">"gold"</span>)</span>
<span id="cb34-22"><a href="#cb34-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-23"><a href="#cb34-23" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>CPU times: user 166 ms, sys: 12.5 ms, total: 179 ms
Wall time: 153 ms</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="genjax_expo_0_files/figure-html/cell-29-output-2.png" class="img-fluid"></p>
</div>
</div>
<section id="benchmarking-is-malamh-rejuvenation" class="level3">
<h3 class="anchored" data-anchor-id="benchmarking-is-malamh-rejuvenation">Benchmarking IS + MALA/MH rejuvenation</h3>
<p>Finally, we can also benchmark this variant.</p>
<div class="cell" data-execution_count="30">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Inference function.</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> _sir_rejuv(key, <span class="op">*</span>args):</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>    key, tr <span class="op">=</span> sir_rejuv(key, <span class="op">*</span>args)</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>    score <span class="op">=</span> tr.get_score()</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> key, score</span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Benchmark function.</span></span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> benchmark_sir_rejuv(key, num_data_points, device<span class="op">=</span>jax.devices()[<span class="dv">0</span>]):</span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a>    x, y <span class="op">=</span> make_data(num_data_points)</span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a>    observations <span class="op">=</span> genjax.choice_map(</span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a>        {<span class="st">"ys"</span>: genjax.vector_choice_map(genjax.choice_map({(<span class="st">"y"</span>, <span class="st">"value"</span>): y}))}</span>
<span id="cb36-13"><a href="#cb36-13" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb36-14"><a href="#cb36-14" aria-hidden="true" tabindex="-1"></a>    key, times <span class="op">=</span> benchmark(key, _sir_rejuv, observations, (x,), device<span class="op">=</span>device)</span>
<span id="cb36-15"><a href="#cb36-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> key, times</span>
<span id="cb36-16"><a href="#cb36-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-17"><a href="#cb36-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-18"><a href="#cb36-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Convenience which allows us to scale data and get times back</span></span>
<span id="cb36-19"><a href="#cb36-19" aria-hidden="true" tabindex="-1"></a><span class="co"># for execution on a specific JAX-managed device.</span></span>
<span id="cb36-20"><a href="#cb36-20" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> test_device(key, data_counts, device):</span>
<span id="cb36-21"><a href="#cb36-21" aria-hidden="true" tabindex="-1"></a>    times <span class="op">=</span> []</span>
<span id="cb36-22"><a href="#cb36-22" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> data_count <span class="kw">in</span> data_counts:</span>
<span id="cb36-23"><a href="#cb36-23" aria-hidden="true" tabindex="-1"></a>        key, ts <span class="op">=</span> <span class="op">%</span>time benchmark_sir_rejuv(key, data_count, device<span class="op">=</span>device)</span>
<span id="cb36-24"><a href="#cb36-24" aria-hidden="true" tabindex="-1"></a>        m <span class="op">=</span> np.mean(ts)</span>
<span id="cb36-25"><a href="#cb36-25" aria-hidden="true" tabindex="-1"></a>        times.append(m)</span>
<span id="cb36-26"><a href="#cb36-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-27"><a href="#cb36-27" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> key, np.array(times)</span>
<span id="cb36-28"><a href="#cb36-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-29"><a href="#cb36-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-30"><a href="#cb36-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Benchmarking.</span></span>
<span id="cb36-31"><a href="#cb36-31" aria-hidden="true" tabindex="-1"></a>data_counts <span class="op">=</span> [<span class="dv">100</span>, <span class="dv">200</span>, <span class="dv">300</span>, <span class="dv">400</span>, <span class="dv">500</span>, <span class="dv">600</span>]</span>
<span id="cb36-32"><a href="#cb36-32" aria-hidden="true" tabindex="-1"></a>f, axes <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">2</span>, sharey<span class="op">=</span><span class="va">True</span>, dpi<span class="op">=</span><span class="dv">280</span>)</span>
<span id="cb36-33"><a href="#cb36-33" aria-hidden="true" tabindex="-1"></a>cpu_ax <span class="op">=</span> axes[<span class="dv">0</span>]</span>
<span id="cb36-34"><a href="#cb36-34" aria-hidden="true" tabindex="-1"></a>gpu_ax <span class="op">=</span> axes[<span class="dv">1</span>]</span>
<span id="cb36-35"><a href="#cb36-35" aria-hidden="true" tabindex="-1"></a>cpu_ax.set_ylabel(<span class="st">"Time (s)"</span>)</span>
<span id="cb36-36"><a href="#cb36-36" aria-hidden="true" tabindex="-1"></a>cpu_ax.set_xlabel(<span class="st">"Num. data points"</span>)</span>
<span id="cb36-37"><a href="#cb36-37" aria-hidden="true" tabindex="-1"></a>gpu_ax.set_xlabel(<span class="st">"Num. data points"</span>)</span>
<span id="cb36-38"><a href="#cb36-38" aria-hidden="true" tabindex="-1"></a>key, cpu_times <span class="op">=</span> test_device(key, data_counts, cpu_device)</span>
<span id="cb36-39"><a href="#cb36-39" aria-hidden="true" tabindex="-1"></a>key, gpu_times <span class="op">=</span> test_device(key, data_counts, gpu_device)</span>
<span id="cb36-40"><a href="#cb36-40" aria-hidden="true" tabindex="-1"></a>cpu_ax.scatter(data_counts, cpu_times)</span>
<span id="cb36-41"><a href="#cb36-41" aria-hidden="true" tabindex="-1"></a>gpu_ax.scatter(data_counts, gpu_times)</span>
<span id="cb36-42"><a href="#cb36-42" aria-hidden="true" tabindex="-1"></a>f.suptitle(<span class="st">"SIR + MH/MALA rejuv Runtime (CPU vs. GPU)"</span>)</span>
<span id="cb36-43"><a href="#cb36-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-44"><a href="#cb36-44" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>CPU times: user 3min 34s, sys: 1.93 s, total: 3min 36s
Wall time: 2min 11s
CPU times: user 8min 29s, sys: 8.49 s, total: 8min 37s
Wall time: 3min 44s
CPU times: user 13min 42s, sys: 12.2 s, total: 13min 54s
Wall time: 5min 34s
CPU times: user 19min 42s, sys: 14.8 s, total: 19min 57s
Wall time: 7min 27s
CPU times: user 24min 56s, sys: 16.8 s, total: 25min 13s
Wall time: 9min 32s
CPU times: user 30min 39s, sys: 17.3 s, total: 30min 56s
Wall time: 11min 47s
CPU times: user 25.7 s, sys: 1.73 s, total: 27.5 s
Wall time: 22.4 s
CPU times: user 20.7 s, sys: 1.53 s, total: 22.2 s
Wall time: 17.2 s
CPU times: user 24.1 s, sys: 1.66 s, total: 25.7 s
Wall time: 20.5 s
CPU times: user 27.1 s, sys: 1.87 s, total: 28.9 s
Wall time: 23.6 s
CPU times: user 30.2 s, sys: 1.69 s, total: 31.9 s
Wall time: 26.7 s
CPU times: user 32.5 s, sys: 2.05 s, total: 34.6 s
Wall time: 29.3 s</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="genjax_expo_0_files/figure-html/cell-30-output-2.png" class="img-fluid"></p>
</div>
</div>


</section>
</section>


</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">© Copyright 2022 <a href="http://probcomp.csail.mit.edu/">MIT Probabilistic Computing Project</a></div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>



</body></html>